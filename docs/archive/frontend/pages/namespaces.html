<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src 'self' data:; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline'; connect-src 'self';" />
  <title>LearnLab - Namespaces</title>
  <style> body { font-family: sans-serif; margin: 1rem; } pre { white-space: pre-wrap; }</style>
</head>
<body>
  <nav>
    <a href="./index.html">Chat</a>
    <a href="./ingest.html">Ingestion</a>
    <a href="./namespaces.html">Namespaces</a>
    <a href="./jobs.html">Jobs</a>
  </nav>
  <h1>Namespaces</h1>
  <button id="refresh">Refresh</button>
  <ul id="list"></ul>
  <h3>Stats</h3>
  <pre id="stats"></pre>
  <script type="module">
    import { listNamespaces, namespaceStats, deleteNamespace } from '../api_client.js';
    const ul = document.getElementById('list');
    const stats = document.getElementById('stats');
    async function load() {
      ul.innerHTML = '';
      const res = await listNamespaces();
      (res.namespaces || []).forEach(ns => {
        const li = document.createElement('li');
        const a = document.createElement('a'); a.href='#'; a.textContent=ns; a.onclick=async()=>{ stats.textContent='...'; stats.textContent = JSON.stringify(await namespaceStats(ns), null, 2); };
        const del = document.createElement('button'); del.textContent='Delete'; del.onclick=async()=>{ await deleteNamespace(ns); await load(); };
        li.appendChild(a); li.appendChild(document.createTextNode(' ')); li.appendChild(del);
        ul.appendChild(li);
      });
    }
    document.getElementById('refresh').onclick = load; load();
  </script>
</body>
</html>
